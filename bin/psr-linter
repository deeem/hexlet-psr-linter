#!/usr/bin/env php

<?php

require_once __DIR__ . '/../vendor/autoload.php';

$path = $argv[1] ?? null;
$msg = "Usage: psr-linter filename\n";

if (!file_exists($path)) {
    exit($msg);
}

$pathinfo = pathinfo($path);
if (!$pathinfo['extension'] == strtolower('php')) {
    exit($msg);
}

$linter = new \PsrLinter\Linter(file_get_contents($path));
$errors = $linter->validate();

if (empty($errors)) {
    exit;
}

file_put_contents('php://stderr', \PsrLinter\Reporter::stdout($errors));
